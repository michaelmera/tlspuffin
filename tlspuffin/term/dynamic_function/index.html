<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module provides traits for calling rust functions dynamically. All functions which implement the DynamicFunction trait can be called by passing an array of [`Any`]s to it. The return value is again of type [`Any`]."><meta name="keywords" content="rust, rustlang, rust-lang, dynamic_function"><title>tlspuffin::term::dynamic_function - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><script defer src="../../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../tlspuffin/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../../tlspuffin/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Module dynamic_function</a></h2><div class="sidebar-elems"><section><div class="block"><ul><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div></section><div id="sidebar-vars" data-name="dynamic_function" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../../tlspuffin/index.html"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Module <a href="../../index.html">tlspuffin</a>::<wbr><a href="../index.html">term</a>::<wbr><a class="mod" href="#">dynamic_function</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../../src/tlspuffin/term/dynamic_function.rs.html#1-329">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module provides traits for calling rust functions dynamically.
All functions which implement the DynamicFunction trait can be called by passing an array of
<a href="https://doc.rust-lang.org/1.60.0/core/any/trait.Any.html" title="Any"><code>Any</code></a>s to it. The return value is again of type <a href="https://doc.rust-lang.org/1.60.0/core/any/trait.Any.html" title="Any"><code>Any</code></a>.</p>
<p>Rust is a statically typed language. That means the compiler would be able to statically verify
that a term evaluates without any type errors.</p>
<p>While this is generally an advance, in the case of our fuzzer this is not very helpful.
The fuzzer should be able to mutate the term trees arbitrarily. Of course, we also have
to check for the types during runtime. If types are not compatible then, the evaluation
of the term will fail. But this is not something that can be done during compile time.
Therefore, we introduced a trait for dynamically typed functions on top of statically
typed Rust functions.</p>
<p>Each function which implements the following trait can be made into a dynamic function:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">tlspuffin::tls::error::FnError</span>;
<span class="kw">type</span> <span class="ident">ConcreteFunction</span><span class="op">&lt;</span><span class="ident">A1</span>, <span class="ident">A2</span>, <span class="ident">A3</span>, <span class="ident">R</span><span class="op">&gt;</span> <span class="op">=</span> <span class="kw">dyn</span> <span class="ident">Fn</span>(<span class="ident">A1</span>, <span class="ident">A2</span>, <span class="ident">A3</span>) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">R</span>, <span class="ident">FnError</span><span class="op">&gt;</span>;</code></pre></div>
<p>where <code>A1</code>, <code>A2</code>, <code>A3</code> are argument types and <code>R</code> is the return type. From these statically
typed function we can generate dynamically types ones which implement the following trait:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">tlspuffin::tls::error::FnError</span>;
<span class="kw">use</span> <span class="ident">std::any::Any</span>;

<span class="kw">pub</span> <span class="kw">trait</span> <span class="ident">DynamicFunction</span>: <span class="ident">Fn</span>(<span class="kw-2">&amp;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">Box</span><span class="op">&lt;</span><span class="kw">dyn</span> <span class="ident">Any</span><span class="op">&gt;</span><span class="op">&gt;</span>) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">Box</span><span class="op">&lt;</span><span class="kw">dyn</span> <span class="ident">Any</span><span class="op">&gt;</span>, <span class="ident">FnError</span><span class="op">&gt;</span> {
}</code></pre></div>
<p>Note, that both functions return a <code>Result</code> and therefore can gracefully fail.</p>
<p><code>DynamicFunctions</code> can be called with an array of any type. The result type is also arbitrary.
Rust offers a unique ID for each type. Using this type we can check during runtime whether
types are available. The types of each variable, constant and function are preserved and
stored alongside the <code>DynamicFunction</code>.</p>
<p>The following function is a simple example for a constant:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">rustls::CipherSuite</span>;
<span class="kw">use</span> <span class="ident">tlspuffin::tls::error::FnError</span>;

<span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">fn_cipher_suites</span>() -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">CipherSuite</span><span class="op">&gt;</span>, <span class="ident">FnError</span><span class="op">&gt;</span> {
    <span class="prelude-val">Ok</span>(<span class="macro">vec!</span>[<span class="ident">CipherSuite::TLS13_AES_128_GCM_SHA256</span>])
}</code></pre></div>
<p>It returns one possibility for the cipher suites which could be sent during a <code>ClientHello</code>.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DynamicFunctionShape.html" title="tlspuffin::term::dynamic_function::DynamicFunctionShape struct">DynamicFunctionShape</a></div><div class="item-right docblock-short"><p>Describes the shape of a <a href="trait.DynamicFunction.html" title="DynamicFunction"><code>DynamicFunction</code></a></p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TypeShape.html" title="tlspuffin::term::dynamic_function::TypeShape struct">TypeShape</a></div><div class="item-right docblock-short"></div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.DescribableFunction.html" title="tlspuffin::term::dynamic_function::DescribableFunction trait">DescribableFunction</a></div><div class="item-right docblock-short"><p>This trait is implemented for function traits in order to:</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.DynamicFunction.html" title="tlspuffin::term::dynamic_function::DynamicFunction trait">DynamicFunction</a></div><div class="item-right docblock-short"><p>Cloneable type for dynamic functions. This trait is automatically implemented for arbitrary
closures and functions of the form: <code>Fn(&amp;Vec&lt;Box&lt;dyn Any&gt;&gt;) -&gt; Box&lt;dyn Any&gt;</code></p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.make_dynamic.html" title="tlspuffin::term::dynamic_function::make_dynamic fn">make_dynamic</a></div><div class="item-right docblock-short"></div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="tlspuffin" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.60.0 (7737e0b5c 2022-04-04)" ></div>
</body></html>